# AI登場人物一覧（LLMリレー / Codex / ChatGPT）

> repo=vpm-mini / branch=main  
> 本ドキュメントは、vpm-mini プロジェクトに登場する AI 的な役者の役割と関係性を整理し、  
> 会話や設計で混線しないための「名前辞書」として使う。

---

## 0. 全体像

このプロジェクトには、少なくとも次の 5 人の「AI的な登場人物」がいる：

1. ChatGPT（プロジェクト常駐）
2. LLMリレー（GitHub Actions 内の LLM 呼び出し）
3. VM Codex（devbox VM 上の実行オペレーター）
4. Mac Codex（ローカル Mac 上の実行オペレーター）
5. Web UI Codex（ChatGPT 画面の CODEx 機能）

重要な前提：

- **頭脳（LLMモデル）はすべてクラウド側にあり、Mac/VM/GKE には LLM 本体は載っていない。**
- Mac や VM はあくまで「手足（実際にファイルやインフラを操作する場）」。
- 各登場人物は、「どの頭脳を使い」「どの手足（Mac / VM / GitHub / GKE）を動かすか」が違うだけ。

---

## 1. ChatGPT（プロジェクト常駐）

### 一言キャッチ
> vpm-mini の「参謀役」  
> 現在地 C / 目標 G / 差分 δ を整理し、設計・文章・手順書を考える係。

### 主な役割

- STATE / docs / reports / 会話ログをまたいだ **文脈理解**。
- プロジェクト全体の C / G / δ の整理。
- LLMリレーや Codex にやらせるべきタスクの **設計・分解・brief 作成**。
- docs/ や reports/ の文章案を作成し、SSOT 更新の入力とする。

### 実行に関する前提

- ChatGPT 自身は `git` や `kubectl` を直接叩かない。
- ソースや SSOT の更新は、**Mac Codex / VM Codex / LLMリレー 経由の PR** で行う。
- ChatGPT は常に「設計と文章」までを担当し、実行は他の登場人物に委ねる。

---

## 2. LLMリレー（GitHub Actions 内）

### 一言キャッチ
> GitHub 上の `/ask` に反応して、  
> 指示書やレポート案をテキストで吐き出す「バッチプランナー候補」。

### 主な役割（現状）

- GitHub Issue / PR コメントの `/ask ...` をきっかけに workflow が起動。
- OpenAI API（現状 `model: gpt-5`）を呼び出し：
  - 指示書（brief）
  - 実行コマンド案
  - レポート案
  を **テキストとして GitHub に書き出す**。

### 住んでいる場所 / 実行環境

- `.github/workflows/*.yml` の中で動く GitHub Actions ジョブ。
- GitHub が用意する一時コンテナ上で動き、OpenAI API に HTTP でアクセス。

### 権限

- `GITHUB_TOKEN` や WIF で付与された権限の範囲で：
  - コメント投稿
  - ラベル操作
  - PR 作成・更新
  などを行う。
- **Codex や devbox に直接ログインする権限は持たない。**

### 将来の立ち位置

- 将来的には「job.json を発行するプランナー / スケジューラ」として育てる。
- 実行は VM Codex / runner 側が担当し、LLMリレーは「何をいつやるか」を決める役に寄せていく。

---

## 3. VM Codex（devbox オペレーター）

### 一言キャッチ
> devbox-codex VM にログインして手を動かす「リモート実行オペレーター」。  
> 将来の「本番実行エージェント」候補。

### 主な役割

- GCE 上の devbox VM（例: `devbox-codex`）に SSH 相当で入り：
  - `git` / `gh`
  - `kubectl`
  - シェルスクリプト
  - ファイル編集（`cat > file <<'EOF'` など）
  を人間の代わりに実行する。
- ChatGPT や LLMリレー（および啓）から渡された brief / job 定義を読み、  
  devbox 内での具体的な操作に落とし込む。

### 住んでいる場所 / 実行環境

- **頭脳**：クラウド側の Codex モデル（例: `gpt-5.1-codex-max`）。  
- **手足**：GCE 上の devbox VM（Ubuntu, Git, gh, kubectl, vpm-mini のソース等）。

### 権限

- devbox 上に設定された GitHub / GCP クレデンシャルの範囲で、PR 作成や kubectl 実行が可能。
- 「VM Codex が `git push` した」ことは、「人間が devbox で `git push` した」のと同じ扱いとなる。

### 将来の立ち位置

- LLMリレー が発行する job.json を読み、  
  **「指定された仕事だけを安全かつ冪等に実行する実行エージェント」** として育てる。
- 本番の 24/7 グルグル運用では、devbox / GKE 側の実行係として振る舞う。

---

## 4. Mac Codex（ローカル Mac オペレーター）

### 一言キャッチ
> ローカル Mac 上で手を動かす「最強の開発ジョーカー」。  
> ただし本番グルグル基盤にはしない。

### 主な役割

- 啓のローカル Mac に対して：
  - ソースコード編集
  - `git` 操作
  - ローカルのツール実行
  を行う Codex オペレーター。

### 特徴

- 権限・ツールが最も揃っており、**開発スピードを出すには最適**。
- その一方で：
  - スリープ / 電源OFF / 持ち歩き など、人間の生活に強く依存する。
  - 24/7 自動実行や「属人性の排除」の観点からは、本番基盤としては不向き。

### 位置づけ

- 短期〜中期：
  - 「LLMリレー ↔ 実行エージェント」仕組みの **実装・検証担当** として活用する。
- 長期：
  - 本番グルグルのループ基盤は VM / GKE 側に移し、Mac Codex は「開発・デバッグ用」に限定する。

---

## 5. Web UI Codex（ChatGPT の CODEx 機能）

### 一言キャッチ
> ChatGPT 画面から devbox / Mac に接続して操作できるオペレーター。  
> 現状、vpm-mini ではほぼ未使用の別人格。

### 主な役割

- ChatGPT Web UI の「CODEx」タブを通じて：
  - devbox や Mac に SSH / リモート接続し、
  - ファイル編集やコマンド実行を行う。
- モデル（例: `gpt-5.1-codex-max`）を UI から切り替え可能。

### 現状の位置づけ

- vpm-mini プロジェクトでは、まだ明示的な運用フローには組み込まれていない。
- 必要になったタイミングで、本ドキュメントと `ai_loop_current_state.md` を参照させ、  
  他の登場人物と矛盾しない形で役割を定義する。

---

## 6. このドキュメントの扱い

- 本ドキュメントは、**AI登場人物の役割と関係性を記述した SSOT** とする。
- 新しい AI エージェントや運用パターンを追加する場合は：
  - ここに新しい登場人物を追記するか、
  - 既存の役割を更新する PR を通して変更する。
- 変更は必ず PR 経由で行い、ChatGPT（参謀役）との対話を通じて  
  「誰が何を担当するのか」がブレないように保つ。
