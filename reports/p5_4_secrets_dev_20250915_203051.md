# P5-4 External Secrets — Kubernetes provider (Trial)
- datetime(UTC): 2025-09-15T20:30:51Z
- context: kind-kind

## Applied
- infra/external-secrets/kubernetes/secretstore.yaml
- infra/external-secrets/kubernetes/externalsecret_demo.yaml

## Status (ExternalSecret)
```yaml
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  creationTimestamp: "2025-09-15T20:25:57Z"
  generation: 1
  name: demo-api-key
  namespace: secrets-system
  resourceVersion: "314131"
  uid: 8e8c5b50-ec85-49b8-8be0-d4c69b2b95be
spec:
  data:
  - remoteRef:
      conversionStrategy: Default
      decodingStrategy: None
      key: demo-source
      metadataPolicy: None
      property: api-key
    secretKey: api-key
  refreshInterval: 1m
  secretStoreRef:
    kind: SecretStore
    name: k8s-source-store
  target:
    creationPolicy: Owner
    deletionPolicy: Retain
    name: demo-synced
status:
  binding:
    name: demo-synced
  conditions:
  - lastTransitionTime: "2025-09-15T20:26:12Z"
    message: Secret was synced
    reason: SecretSynced
    status: "True"
    type: Ready
  refreshTime: "2025-09-15T20:26:12Z"
  syncedResourceVersion: "314131"
```

## Synced K8s Secret
- name: secrets-system/demo-synced
- api-key (decoded): trial-1757967795

## DoD
- [x] ExternalSecret READY（status.conditions Ready=True）
- [x] secrets-system/demo-synced が作成され、api-key が取得できる（空でない）

## Implementation Notes
- Updated API version from v1beta1 to v1 for compatibility
- Added RBAC permissions for default service account to access secrets
- Used secrets-system namespace for both SecretStore and ExternalSecret
- Added CA provider configuration for kubernetes provider authentication