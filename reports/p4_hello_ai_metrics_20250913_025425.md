# P4-A Evidence: Hello AI Observability (20250913_025425)

## Environment Configuration
- **APP_NS**: hyper-swarm
- **PROM_RELEASE**: vpm-mini-kube-prometheus-stack
- **Timestamp**: 2025-09-12 17:54:25 UTC

## DoD Verification Results
| Check | Status | Details |
|-------|--------|---------|
| /metrics endpoint | ⚠️ | Service: hello-ai-metrics:9090 |
| ServiceMonitor | ✅ | Namespace: monitoring, Release: vpm-mini-kube-prometheus-stack |
| Prometheus discovery | ⚠️ | Target health: pending |
| Grafana dashboard | ✅ | ConfigMap: grafana-dashboard-hello-ai |
| PrometheusRule | ✅ | Alerts: ServiceDown, HighLatency, HighErrorRate |

## Applied Resources
### Application Layer (hyper-swarm)
- `ksvc/hello-ai`: Knative Service with metrics annotations
- `svc/hello-ai-metrics`: ClusterIP service exposing port 9090

### Monitoring Layer (monitoring)
- `servicemonitor/hello-ai`: Scrape configuration for Prometheus
- `cm/grafana-dashboard-hello-ai`: Dashboard definition (sidecar-compatible)
- `prometheusrule/hello-ai-minimal`: Alert rules for SLO tracking

## Verification Commands
```bash
# Check metrics endpoint
kubectl -n hyper-swarm port-forward svc/hello-ai-metrics 9090:9090
curl localhost:9090/metrics | grep -E "^(hello_ai_|http_request_)"

# Verify ServiceMonitor
kubectl -n monitoring get servicemonitor hello-ai -o yaml

# Check Prometheus targets
kubectl -n monitoring port-forward svc/prometheus-operated 9090:9090
curl localhost:9090/api/v1/targets | jq '.data.activeTargets[] | select(.labels.job | test("hello-ai"))'

# View alerts
kubectl -n monitoring get prometheusrule hello-ai-minimal -o yaml
```

## Grafana Dashboard Access
1. Port-forward to Grafana: `kubectl -n monitoring port-forward svc/grafana 3000:80`
2. Login with admin credentials
3. Navigate to Dashboards → Browse
4. Look for "Hello AI / SLO" dashboard (auto-imported via sidecar)

## Alert Definitions
- **HelloAIServiceDown**: Triggers when metrics endpoint is unreachable for 2+ minutes
- **HelloAIHighLatency**: P95 latency exceeds 500ms for 5+ minutes  
- **HelloAIHighErrorRate**: 5xx error rate exceeds 5% for 5+ minutes

## Notes
- ServiceMonitor uses label selector `app: hello-ai` to discover the metrics service
- Dashboard ConfigMap labeled with `grafana_dashboard: "1"` for sidecar auto-discovery
- PrometheusRule labeled with `release: vpm-mini-kube-prometheus-stack` for Prometheus Operator pickup
- All resources are idempotent and can be reapplied safely

---
Generated by P4 Observability One-Shot Script
